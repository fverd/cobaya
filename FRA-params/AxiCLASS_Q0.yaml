likelihood:
  pbjboss:
    python_path: pbj4cobaya/
    pbj_path: pbj-multiz/
    stop_at_error: True
    theory:
      linear: cobaya 
      scale_dependent_growth: False
      IRresum: True
      IRresum_kind: EH # options EH, DST
      do_redshift_rescaling: False
    likelihood:
      observables: ['P0', 'P2', 'P4', 'Q0']
      model: model_varied_cosmology_analytic_marg_multiz_withchi
      type: Gaussian # options: Gaussian, Hartlap, Sellentin
      cosmology: varied # options: fixed, varied
      do_analytic_marg: True
      # store_theorydict: True
    marg_params: 
      bG3:
        mean: [0., 0., 0., 0.]
        sigma: [1., 1., 1., 1.]
      c0:
        mean: [0., 0., 0., 0.]
        sigma: [30., 30., 30., 30.]
      c2:
        mean: [30., 30., 30., 30.]
        sigma: [30., 30., 30., 30.]
      c4:
        mean: [0., 0., 0., 0.]
        sigma: [30., 30., 30., 30.]
      ck4:
        mean: [500., 500., 500., 500.]
        sigma: [500., 500., 500., 500.]
      aP:
        mean: [0., 0., 0., 0.]
        sigma: [2., 2., 2., 2.]
      e0k2:
        mean: [0., 0., 0., 0.]
        sigma: [2., 2., 2., 2.]
      e2k2:
        mean: [0., 0., 0., 0.]
        sigma: [2., 2., 2., 2.]
    covariance:
      type: covariance # options: covariance, variance
      file: [C_024Q_ngc_z1.txt,C_024Q_sgc_z1.txt,C_024Q_ngc_z3.txt,C_024Q_sgc_z3.txt]
    which_Plin: delta_tot # options delta_tot, delta_nonu (i.e. cb)

params:
  omega_scf:
    prior:
      min: 0.0
      max: 0.08
    latex: \Omega_{a} h^2
    drop: True

  Omega_scf:
    value: 'lambda omega_scf, h: omega_scf/h/h'

  omega_cdm:
    prior:
      min: 0.02
      max: 0.2
    latex: \Omega_\mathrm{c} h^2

  m_axion_eV: 
    value: 1.e-25
    drop: True

  m_axion:
    value: 'lambda m_axion_eV, h: m_axion_eV*1.56e29/3.336e-04/h'

  kJ0p5: 
    value: 'lambda m_axion_eV, h: 8.4e12 * np.sqrt(m_axion_eV/h) * (0.6666)**0.25'

  h:
    prior:
      min: 0.6
      max: 0.85
    latex: h

  omega_b:
    prior:
      min: 0.01
      max: 0.04
    latex: \Omega_\mathrm{b} h^2

  logA:
    prior:
      min: 2.
      max: 3.8
    latex: \log(10^{10} A_\mathrm{s})
    drop: True

  A_s:
    value: 'lambda logA: 1e-10*np.exp(logA)'
    latex: A_\mathrm{s}

  n_s:
    prior:
      min: 0.6
      max: 1.2

  # Mnu: 0.06
  tau_reio: 0.0544

theory:
  classy:
    extra_args:
      N_ncdm: 0.
      N_ur: 3.046
      # N_ncdm: 1
      # N_ur: 2.0328
      non_linear: False
      tol_shooting_deltax: 1e-4
      tol_shooting_deltaF: 1e-4
      scf_parameters : '0.05,0.0' ## note: if Omega_scf is set, the parameter entry corresponding to scf_tuning_index is ignored and used for shooting.
      scf_tuning_index: 0  # in this example, we shoot over theta_ini in order to adjust Omega_scf.
      scf_evolve_as_fluid: 'yes'  # if set to yes, will switch for fluid when threshold_scf_fluid_m_over_H is met
      scf_evolve_like_axionCAMB: 'yes'  # fluid all the time in perts, the option no is currently bugging, to be debugged
      threshold_scf_fluid_m_over_H: 3  # threshold_scf_fluid_m_over_H controls when to switch to fluid
      do_shooting: 'yes'  # controls shooting in general; e.g. theta_s
      do_shooting_scf: 'yes'  # necessary when log10_axion_ac & log10_fraction_axion_ac are chosen
      scf_has_perturbations: 'yes'  # for pedagogical purposes only
      use_big_theta_scf: 'no'  # in perts with the fluid it is often more stable to follow the heat flux rather "Big Theta=(1+w)*Theta" than the velocity divergence "Theta"
      use_delta_scf_over_1plusw: 'no'
      attractor_ic_scf: 'no'  # some specific IC for tracker potentials
      # evolver: 0

      scf_potential: axion
      n_axion: 1
      f_axion: 0.4  # in units of mpl

    stop_at_error: False
    ignore_obsolete: True
    renames:
      Mnu: m_ncdm

# debug: True
sampler:
  # evaluate:
  nautilus:
    poolN: 72

  
output: chains/Axi25_CPTcount/chain
